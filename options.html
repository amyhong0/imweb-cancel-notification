<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>아임웹 취소 접수 알림 - 설정</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 480px;
      margin: 24px auto;
      padding: 0 16px;
    }
    h1 { font-size: 1.25rem; margin-bottom: 8px; }
    p { color: #666; font-size: 0.9rem; margin-bottom: 16px; }
    label { display: block; font-weight: 500; margin-bottom: 4px; }
    input[type="text"], input[type="password"], input[type="number"] {
      width: 100%;
      padding: 8px 12px;
      margin-bottom: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    input[type="number"] { width: 100px; }
    .hint { font-size: 0.8rem; color: #888; margin-top: -8px; margin-bottom: 12px; }
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
    }
    button:hover { background: #1d4ed8; }
    .status { margin-top: 16px; font-size: 0.9rem; }
    .status.ok { color: #059669; }
    .status.err { color: #dc2626; }
    a { color: #2563eb; }
  </style>
</head>
<body>
  <h1>아임웹 취소 접수 알림 설정</h1>
  <p>아임웹 API 키를 입력하면 주기적으로 취소 접수(승인 대기) 건을 확인하고, 새 건이 생기면 데스크톱 알림을 띄웁니다.</p>

  <label for="apiKey">API Key</label>
  <input type="text" id="apiKey" placeholder="아임웹 관리자 > 개발자센터에서 발급">
  <p class="hint">아임웹 관리자 → 설정 → 개발자센터에서 API 키를 발급받을 수 있습니다.</p>

  <label for="apiSecret">API Secret</label>
  <input type="password" id="apiSecret" placeholder="API Secret">

  <label for="intervalValue">확인 간격</label>
  <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
    <input type="number" id="intervalValue" min="1" max="60" value="5" style="width: 80px;">
    <select id="intervalUnit" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ccc;">
      <option value="min">분</option>
      <option value="hour">시간</option>
    </select>
  </div>
  <p class="hint">분: 1~60분. 시간: 1~168시간(7일). 너무 짧으면 API 제한에 걸릴 수 있습니다.</p>

  <button id="save">저장</button>
  <button id="test">연결 테스트</button>
  <button id="checkNow">지금 확인</button>
  <button id="clearNotified" type="button" style="background:#6b7280;">알림 이력 초기화</button>
  <button id="testNotification" type="button" style="background:#059669;">테스트 알림</button>

  <div id="status" class="status"></div>
  <p class="hint">테스트 알림이 안 뜨면: macOS는 <strong>시스템 설정 → 알림 → Google Chrome → 알림 허용</strong>, Chrome은 <strong>설정 → 개인정보 및 보안 → 사이트 설정 → 알림</strong>에서 허용해 주세요.</p>
  <p class="hint">취소 접수 알림이 안 뜨면: 알림 이력 초기화 → 지금 확인. (이미 알림 보낸 건은 다시 안 뜸)</p>

  <p style="margin-top: 24px;">
    <a href="https://developers.imweb.me" target="_blank" rel="noopener">아임웹 개발자센터</a>
  </p>

  <!-- options.js를 먼저 로드해 버튼이 항상 동작하도록 함 (credentials 실패 시에도) -->
  <script src="options.js"></script>
  <script src="credentials.default.js"></script>
</body>
</html>
